# 高性能计算那些内行不会告诉你的秘密

2017年10月，有幸受邀参加了2017·HPC CHINA大会。本届大会属历届规模之最，有1500多位参会者，为促进参会者充分交流，因此会议时间安排得也与一般会议不同：主会之前安排了CCF会议以及几个技术培训专场，接着1天半为独立主会场的演讲，随后一天半为三十余个分论坛。参会的人除了厂商，主要是学术背景的力量，有超算中心、高校、研究院所，以企业用户身份参会的人很少。

## **1：不同行业从业者对HPC理解差距很大**

在我看来，HPC的学科源头为计算机科学，后因为国家在HPC领域的大规模投资，建设了一批国家级超算中心，使得我国在硬件水平上远超其它国家。后因为缺乏超大规模应用的计算需求，利用率一直较低。这个问题在近几年得到了较好的解决，气象、石油、生命科学、大数据等学科的发展，使得超大规模问题的计算需求逐渐旺盛起来，利用率也逐渐提升。

HPC行业从业者自此由计算机学术研究者一支，扩展到了应用使用者。计算机学术研究者主要关注的问题为，HPC计算系统的体系架构设计，如何实现更高的单位时间计算速度（万亿次/秒、亿亿次/秒…）、功耗如何更低、随着计算规模的增加存储性能如何提升…而应用使用者主要关心的是如何实现超大规模计算问题的求解，如何更短时间内求解出问题等。因此，在计算机学术研究者眼中的HPC，更像是在汽车工程师眼中的汽车一样，分很多详细的部件，主板（底盘），总线（传动），CPU（动力），内存（燃油）…如何设计才能使得这些部件之间得以能更高效的协作，发挥出更高的性能。而应用使用者眼中的HPC，更像是一般消费者对苹果手机的视角，开包即用，买一个HPC回来，能不能在“2小时”内完成“未来24小时天气预报”的计算，如何通过计算程序的优化，使得计算时间从“2小时”缩短为“1.5小时”。

 

## **2：打造高水平的HPC产品，只能靠汽车企业自己上心**

家用电脑主要是用做通用计算，选购主要看价钱。与家用电脑不同的是，HPC求解的往往都是超大计算规模的问题，是专业用途，所以应用算法对计算系统的体系结构是有要求的。如果能够实现对应用的算法进行针对性的体系架构设计，会有非常明显的计算效率提升，还可以相比通用计算目的设计的HPC节约不少非必要的硬件设备投入。

然而，不少应用HPC的单位，甚至包括一些研究所这样人员素质较高的单位，由于内部IT工程师并非HPC的专业从业者， HPC的建设和运营仍然依靠供应商主导，简单保守起见，HPC体系结构的设计均采用通用方案简单修改，往往一旦建设完成，很少进行体系架构层面的变更。因此难免会出现发现性能瓶颈，再搞一期项目改一下，或者投资不少，但是因为设计不到位，导致并没有发挥出系统真正的价值，花了不少冤枉钱，甚至不自知。

汽车企业应用HPC主要是用商业数值仿真分析软件求解CAE题目，相比气象、石油、基因测序等应用，单个计算任务的求解规模要小得多，但由于汽车设计涉及到多个学科，用到的CAE仿真软件有上百种，计算任务的数量也不少。由于软件种类多，且许可费用高昂，如果体系结构能针对不同软件不同算法设计和优化，大幅缩短计算时间成为可能，从而提高许可利用效率，压缩研发周期，在规定时间内完成更多轮次的迭代，进而提升汽车品质。汽车品质的好坏并不是系统集成商、硬件厂商、软件厂商、云服务提供商等所最关心的，如果车企自己不上心，这个问题的后果只能自己承担甚至还不自知，当业务不得不把题目交给第三方公司计算，对比计算时间和结果才有所发现时，已经悔之晚矣。

 

## **3：提升运营水平的突破点在于模式创新**

目前为汽车企业提供HPC运营服务的主要力量是调度软件厂商、系统集成商，技术支持服务主要是代替企业运维，排除系统运行各种故障。车企用的HPC建成后往往很少有硬件上的改动，为了控制成本，服务的方式多为远程技术支持，实在解决不了，才转现场支持。购买高水准服务的车企少之又少，因为缺乏市场，往往这样的服务售价不菲。如果运维费用压得太低，一些系统集成商会借问题发生难以覆盖成本，提出额外收费的要求，从甲方的角度看来很像“敲诈”。因为竞争不够激烈，市场规范性欠缺，企业能获得的实际服务水平其实并不高。我将这种服务方式定义为“作坊式”运营。

 HPC在汽车企业中扮演的角色是基础设施，相比国际一流车企的现有规模，国内车企HPC规模未来还将成倍增长。这样的低质服务是不能支撑HPC作为基础设施使用的。试想，CAE团队正在攻关一个“急活”，恰好HPC出问题，集成商要求不付费问题就解决不了，而且解决问题还要找管硬件的、管系统的、管调度的、管CAE软件的…一票专家联合会诊，一两天恐怕搞不定。这问题如果在个人工作电脑上计算要俩月，黄花菜都凉了。CAE团队的唯一选择只能是付费委外。

福特通过引入生产线模式，将汽车生产从“每个工人围着固定工位组装汽车要了解全套装配细节”到“每个工人在生产线专门的工位上只负责很少几项装配”，大大提高了生产效率。HPC的运营服务，也应该按照这种细化分工密切协作的方式，升级到“流水线式”运营，只有这样才有可能提供可靠服务，这样的服务模式，才算是做到了“用专业的人，做专业的事”。HelpDesk、问题分级、专家库、DevOps也许将成为“流水线式”运营的关键词。打磨优质产品，外包的团队怎么会像自己那么上心？这样的模式创新，不能靠天，不能靠地，模式升级，建立机制这事只能靠自己。

 

## **4：各位加油！**

不同行业从业者对HPC理解差距很大，当然了！打造高水平的HPC产品，只能靠汽车企业自己上心，当然了！提升运营水平的突破点在于模式创新，当然了！咳咳~吃苹果有益健康，当然了！其实，会上泰斗们讲的都不是这些。这些，会被他们认为是常识。
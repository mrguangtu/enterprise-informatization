# 企业高性能计算混合云的一种形式

《Set up a hybrid high performance computing (HPC) cluster with Microsoft HPC Pack and on-demand Azure compute nodes》文档中描述了一种混合云的实现架构，这可以作为云时代企业建设高性能计算的一种参考。

这种架构，采用了把调度和管理部分放在企业内部，计算资源放在云端的模式。

![HPC混合云的一种形式](..\Images\HPC混合云的一种形式.png)



这种架构的优点在于让企业可以按照负载的波谷建设资源，峰值所需的临时资源采用云端**弹性**解决。节约因拥有较低利用率的资源而产生的费用。

##  按状态划分资源，精益利用资源

**状态**这个概念来自于编程领域，简单的理解就是要存储数据的部分就是有状态的，不需要存储数据的部分就是无状态的。换句话来说，有状态可以理解成私有的，非标准的；无状态的可以理解成共享的，标准的。对于HPC系统，我们可以把资源按照"状态"分成两类，“有状态”和“无状态”的。

对于没有编过程的同学，状态这件事不太容易理解，拿1-5公里出行这件事，我们用共享单车做例子来解释一下“状态”。共享单车涉及到的主要有两类资源，一个是“骑车的人“，一个是车。“骑车的人”是“有状态的”，背后是不同的具体用户，用户的属性（余额、昵称、绑定的银行卡等）都是不同的，是不能随意互换的；而“自行车”是无状态的，对任何乘车者都是一样的，是可以随意互换的。

企业使用HPC进行CAE仿真这件事，也可以进行类似的划分：计算资源是无状态的，是可以替换的；而每一个用户及对应的题目是有状态的，不能随便更换的。

使用云的思路解决问题，本质就是按状态划分资源。对于有状态的资源，保持不变，用信息系统管理起来，提升效率；对于无状态的资源，建立资源池，随用随取，通过调度技术尽可能缩小资源池总量，从而更加精益地建设和使用资源。

## 云的技术价值

云的这种模式，最早来源于电商搞促销活动。一到双11，庞大的用户群体需要访问电商的促销网站，形成了一波强大的DDOS攻击流。为了保证网站可以正常访问，就必须根据峰值配置这么多服务器。但双11一过，流量就恢复到日常水平了，为了应对峰值访问的服务器就此闲置，让电商背负了不少成本。为了提高这部分资源的利用率，就出现了云的模式。

将闲置的服务器卖给有需要服务器的人，提供标准化的托管服务，这些富裕的资源就可以继续的赚钱了。于是电商大佬们纷纷的开始搭建自己的云平台，卖起服务器来，阿里云、腾讯云、京东云纷纷破土而出，茁壮成长。随着这个生意的深耕和细化，除了服务器，还出现了存储、网络、人脸识别等上百种产品，一时间云端竟变得欣欣向荣了起来。我试图从技术角度总结了一下这样模式的价值：

* 集中管理，精益使用

对于一家企业来讲，是怎么都无法充分的“弹性”起来的，毕竟资源总量太小了。而集中的管理庞大的用户群体的资源，就有很大的价值了。如果许多许多企业都使用了云，那么不同时间不同企业对资源需求的峰值和谷值就可以相互冲抵，资源总量就不需要建设那么多了。对于所有用户的总体的拥有成本来说，就会下降不少。这些没有必要再去建设的资源所带来的节约，就可以成为平台与所有用户可以分享的利润。调度策略的优化，也可以提升已建设资源的利用率，使得资源利用更加精益。这样企业减少了成本，平台获得了利润。

- 简化使用，降低门槛

云端构建了非常大的弹性的资源池，不论调度资源的技术多么复杂，是不用骑车的那个人操心的，骑车的人只管骑，骑完给钱就行。同样，现在“共享充电宝”、“滴滴打车”，都是用“云”的套路进行商业创新。类似的逻辑其实很早就有了，比如水厂+供水网络、电厂+国家电网.....对终端用户来说，只需要选择资源、使用资源、按量付费即可，极大的降低了使用门槛。用户再也无需了解数据中心的各种技术，获得了使用的便捷性。

[参考资料](https://docs.microsoft.com/en-us/azure/cloud-services/cloud-services-setup-hybrid-hpcpack-cluster)